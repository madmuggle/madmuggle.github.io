# 这个异常该捕捉吗？



## 成为标配的异常

对于今天的几百种编程语言，「异常」大概属于基础级别的标配了。除了C语言，Go语言，好像也说不出来哪种语言不支持异常了。


## 自由的用法

异常的用法比较自由，哪儿都可以抛，哪儿都可以捕捉。只有Java限制多点，必须在特定地方声明可能抛出的异常，并且不能无视可能产生的异常。

然而任何时候都可以捕捉，那何时应该捕捉？ 任何时候都可以放过，那此时应该放过吗？

本文就是关于这个主题的，并没有什么理论基础，只是讲我的使用感受，仅供参考。


## 无视距离的一跳

暂且抛开「异常」的字面意思不谈，其实它是一种特殊的语言级别的控制流。我们常用的控制流，相信大家早就感觉到其局限性了吧，比如下面这个例子

```js
while (a()) {
  while (b()) {
    while (c()) {
      switch (d()) {
      case 1:
        // assume this is where we are
      }
    }
  }
}
```

在`switch`语句内部，想跳出`while`循环，需要用`break`。但上例情况特殊，break会作用到switch上，结果我们连最里面的循环都跳不出。

这种限制是所有的编程语言都存在的，所以C语言有`goto`，Java的循环支持标签。其他语言怎么办呢？一个肯定可行的办法就是抛异常。

一个未被捕捉的异常，可以把我们带出任意多层循环。而且能跨函数，这一点`goto`都望尘莫及。


## 你想继续，还是停止

有时候你很难判断应该在哪个地方捕捉并处理异常，因为往往几种方案都是可行的。最基本的原则是，如果只需要打印log就足够，那就本地处理掉。

处理的地方离发生的地方越近，程序就越好理解。

举个例子，你要依次处理某个文件夹里面所有的文件，可能有文件不合格，这个时候你就要报异常。

```
TheOutterDirectory
------------------
  |- File1    ok
  |- File2    ok
  |- File3    ERROR!
  |- File4
  |- ...
```

假设`File3`有问题，如果各个文件不相关，就地处理，打一条log。如果要求每个文件都合格，就让异常把我们带出去，跳过其他文件。

这个情况简单很好判断。然而实际编程时，情况往往很复杂，那时候就不容易选择了。

如果你使用异步API，为了错误信息足够准确，方便定位，你可能得捕获了这个异常，用新的异常替换它。

总之，异常如何捕获，看似初级，实际有很大空间，值得我们多留意下呢。
