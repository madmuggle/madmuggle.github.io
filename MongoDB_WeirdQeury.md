# MongoDB奇怪的查询语法
2016/12/09 18:46:00
MongoDB


在MongoDB里面，`$or`表示「逻辑或」，而`,`直接具备了`逻辑与`的功能。我记得以前看到书上这样写的。估计那本书我没看完，因为MongoDB里面有一个`$and`，而且它在嵌套使用时非常重要。


## 不是总管用的逗号

逗号表示「逻辑与」，其实说的通。问题是MongoDB没有把这个理念贯彻到底。比如这种写法，它直接算作是语法错误：

```javascript
db.blah.find({
  $or: [ { a: 1 }, { b: 2 } ],
  $or: [ { c: 3 }, { d: 4 } ]
})
```

这种错误很头疼，如果你使用`MongoBooster`之类的软件，运行之前编辑器就能给你提示，倒也没什么。

但是如果你接手一个项目，对框架不熟悉，碰巧那个框架又在某些失败的查询下，保持沉默，你就一脸懵了。

逻辑明明是对的啊？


## $and

使用`$and`可以解决上面那个问题：

```javascript
db.blah.find({
  $and: [
    { $or: [ { a: 1 }, { b: 2 } ] },
    { $or: [ { c: 3 }, { d: 4 } ] }
  ]
})
```

唯一让人觉得安慰的是，`$and`至少和`$or`保持了语法一致。


